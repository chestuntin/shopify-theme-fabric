{%- if template.name == 'collection' or template.name == 'search' or template.name == 'cart' -%}
{%- if block.settings.border == 'solid' -%}
  {%- liquid
    assign border_color = block.settings.border_custom_color
    if border_color == blank
      assign border_color = "rgb(var(--color-border-rgb) / " | append: block.settings.border_opacity | append: "%)"
    endif
    assign border_width = block.settings.border_width
  -%}
  <style>
    /* Collapsed Border Strategy: Container owns outer, cards own inner dividers */
    /* For product-grid (collection/search pages) */
    .product-grid--{{ section.id }} {
      /* Zero gap - borders will touch */
      --product-grid-gap-mobile: 0 0;
      --product-grid-gap-desktop: 0 0;
      
      /* Container owns TOP and LEFT outer borders */
      border-top: {{ border_width }}px solid {{ border_color }};
      border-left: {{ border_width }}px solid {{ border_color }};
      border-right: none;
      border-bottom: none;
      padding: 0;
    }
    
    .product-grid--{{ section.id }} .product-grid__item {
      /* Each item owns its RIGHT and BOTTOM borders only */
      border: none !important;
      border-right: {{ border_width }}px solid {{ border_color }} !important;
      border-bottom: {{ border_width }}px solid {{ border_color }} !important;
      border-radius: 0 !important;
      box-shadow: none !important;
      margin: 0 !important;
    }

    /* For resource-list (cart/product-list sections) */
    .ui-test-product-list .resource-list--grid {
      /* Override gap CSS variables to zero */
      --resource-list-column-gap-desktop: 0px !important;
      --resource-list-row-gap-desktop: 0px !important;
      --resource-list-column-gap: 0px !important;
      gap: 0 !important;
      
      /* Container owns TOP and LEFT outer borders */
      border-top: {{ border_width }}px solid {{ border_color }};
      border-left: {{ border_width }}px solid {{ border_color }};
      border-right: none;
      border-bottom: none;
    }
    
    .ui-test-product-list .resource-list--grid .resource-list__item {
      /* Each item owns its RIGHT and BOTTOM borders only */
      border: none !important;
      border-right: {{ border_width }}px solid {{ border_color }} !important;
      border-bottom: {{ border_width }}px solid {{ border_color }} !important;
      border-radius: 0 !important;
      box-shadow: none !important;
      margin: 0 !important;
    }

    /* Remove all borders from inner elements */
    .product-grid--{{ section.id }} .product-card,
    .product-grid--{{ section.id }} .product-card__content,
    .product-grid--{{ section.id }} .product-card__content > *,
    .ui-test-product-list .product-card,
    .ui-test-product-list .product-card__content,
    .ui-test-product-list .product-card__content > * {
      border: none !important;
      border-radius: 0 !important;
    }

    /* Add bottom border to card gallery to separate image from title */
    .product-grid--{{ section.id }} .card-gallery,
    .ui-test-product-list .card-gallery {
      border-bottom: {{ border_width }}px solid {{ border_color }} !important;
    }

    /* Disable hover scale/lift animation for cart page product cards */
    .ui-test-product-list .product-card:hover {
      transform: none !important;
    }
  </style>
{%- endif -%}
{%- endif -%}

{%- comment -%} Disable hover animation for cart page product cards - outside of border condition {%- endcomment -%}
{%- if template.name == 'cart' -%}
<style>
  /* Disable hover scale/lift animation for cart page product cards */
  .ui-test-product-list .product-card:hover,
  .ui-test-product-list .product-card:hover .card-gallery {
    transform: none !important;
    scale: none !important;
  }
</style>
{%- endif -%}

{% liquid
  assign product = closest.product
-%}

{% capture children %}
  {% content_for 'blocks', closest.product: product %}
{% endcapture %}

{% render 'product-card', children: children, product: product %}

{% schema %}
{
  "name": "t:names.product_card",
  "blocks": [
    {
      "type": "_product-card-group"
    },
    {
      "type": "text"
    },
    {
      "type": "image"
    },
    {
      "type": "buy-buttons"
    },
    {
      "type": "price"
    },
    {
      "type": "review"
    },
    {
      "type": "swatches"
    },
    {
      "type": "_product-card-gallery"
    },
    {
      "type": "product-title"
    },
    {
      "type": "custom-liquid"
    },
    {
      "type": "@app"
    }
  ],
  "tag": null,
  "settings": [
    {
      "type": "paragraph",
      "content": "t:content.resource_reference_product_card"
    },
    {
      "type": "range",
      "id": "product_card_gap",
      "label": "t:settings.vertical_gap",
      "min": 0,
      "max": 50,
      "step": 1,
      "unit": "px",
      "default": 16
    },
    {
      "type": "checkbox",
      "id": "inherit_color_scheme",
      "label": "t:settings.inherit_color_scheme",
      "default": true
    },
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "t:settings.color_scheme",
      "default": "scheme-1",
      "visible_if": "{{ block.settings.inherit_color_scheme == false }}"
    },
    {
      "type": "header",
      "content": "t:content.borders"
    },
    {
      "type": "select",
      "id": "border",
      "label": "t:settings.style",
      "options": [
        {
          "value": "none",
          "label": "t:options.none"
        },
        {
          "value": "solid",
          "label": "t:options.solid"
        }
      ],
      "default": "none"
    },
    {
      "type": "color",
      "id": "border_custom_color",
      "label": "t:settings.custom_color",
      "visible_if": "{{ block.settings.border != 'none' }}"
    },
    {
      "type": "range",
      "id": "border_width",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "label": "t:settings.thickness",
      "default": 1,
      "visible_if": "{{ block.settings.border != 'none' }}"
    },
    {
      "type": "range",
      "id": "border_opacity",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "%",
      "label": "t:settings.opacity",
      "default": 100,
      "visible_if": "{{ block.settings.border != 'none' }}"
    },
    {
      "type": "range",
      "id": "border_radius",
      "label": "t:settings.border_radius",
      "min": 0,
      "max": 32,
      "step": 1,
      "default": 0
    },
    {
      "type": "header",
      "content": "t:content.padding"
    },
    {
      "type": "range",
      "id": "padding-block-start",
      "label": "t:settings.top",
      "min": 0,
      "max": 50,
      "step": 1,
      "unit": "px",
      "default": 0
    },
    {
      "type": "range",
      "id": "padding-block-end",
      "label": "t:settings.bottom",
      "min": 0,
      "max": 50,
      "step": 1,
      "unit": "px",
      "default": 0
    },
    {
      "type": "range",
      "id": "padding-inline-start",
      "label": "t:settings.left",
      "min": 0,
      "max": 50,
      "step": 1,
      "unit": "px",
      "default": 0
    },
    {
      "type": "range",
      "id": "padding-inline-end",
      "label": "t:settings.right",
      "min": 0,
      "max": 50,
      "step": 1,
      "unit": "px",
      "default": 0
    }
  ]
}
{% endschema %}
